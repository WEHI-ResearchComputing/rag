<p>RStudio OnDemand is the recommended way to use RStudio on the Milton computing cluster. To compare other methods of running R on Milton, refer to the <a href="/sites/rc2/SitePages/R-services.aspx">R Services page</a>.</p><h3><span class="fontColorThemeSecondary">How to Resolve Issues</span></h3><p>If you encounter an issue relating to OnDemand specifically, for example your jobs are unable to start, please follow these steps:</p><p>1. <a href="https://ondemand.hpc.wehi.edu.au/pun/sys/dashboard/batch_connect/sessions">Go to the OnDemand session's dashboard</a><br>2. Click the session ID for the session that is having issues:</p><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Left" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/1369958544-ondemand_session.png" data-imagenaturalheight="245" data-imagenaturalwidth="928" data-uniqueid="fc3b121c-f171-4199-be56-ceaa8f7dca5b" data-height="156.6951107156688" data-width="593.522705078125" data-widthpercentage="52.337420602661965" data-uploading="0"></div><p>3. Open the log file:&nbsp;</p><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Left" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/838726450-output_log.png" data-imagenaturalheight="471" data-imagenaturalwidth="471" data-uniqueid="ada7ac26-32a0-4381-81d7-1c30c275df8c" data-height="240.06393432617188" data-width="240.06393432617188" data-widthpercentage="21.169075748677287" data-uploading="0"></div><p>4. You might find that reading the log file gives you enough information to solve the issue. If it doesn't, submit a helpdesk ticket <strong>including the full contents of output.log</strong></p><h3><span class="fontColorThemeSecondary">Partitions</span></h3><p>The default OnDemand partition is the <strong>interactive </strong>partition. This partition is guaranteed to be available, but <strong>has significant restrictions in terms of the number and size of jobs that can be submitted. </strong>You may find that the regular partition is more suitable for your workflow. For more information, refer to the <a href="/sites/rc2/SitePages/SLURM-partitions.aspx">partition documentation</a>.</p><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Left" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/340130327.png" data-overlaytextstyles="{&quot;textColor&quot;:&quot;light&quot;,&quot;isBold&quot;:false,&quot;isItalic&quot;:false,&quot;textBoxColor&quot;:&quot;dark&quot;,&quot;textBoxOpacity&quot;:0.54,&quot;overlayColor&quot;:&quot;light&quot;,&quot;overlayTransparency&quot;:0}" data-imagenaturalheight="203" data-imagenaturalwidth="625" data-siteid="93ee3842-f21b-4d8d-b85b-874e64c67802" data-webid="95711e2c-a16f-49a8-9adc-1b9756d4ee5e" data-listid="3d75202a-c480-42f5-abb7-5e7b39fc27d5" data-uniqueid="de64c12e-1561-4488-8641-23c3d1b49d60" data-height="129.66278076171875" data-width="399.20806884765625" data-widthpercentage="33.716007820541584" data-uploading="0"></div><h3><span class="fontColorThemeSecondary">Session Management</span></h3><p>Because RStudio OnDemand has transient sessions with a specific time limit, the variables in your environment will not persist between sessions. If you need to preserve you environment, you need to take one of two approaches:</p><ul><li>To always automatically save and restore your sessions, set the following settings in the Global Settings dialogue: &nbsp;</li></ul><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Center" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/2643052562-workspace.png" data-imagenaturalheight="326" data-imagenaturalwidth="600" data-uniqueid="7d3c8113-d85a-4261-94b1-b09854ab2b95" data-height="325.9991928961948" data-width="599.9985145328739" data-widthpercentage="52.90846390104981" data-uploading="0"></div><ul><li>If you take this approach, <strong>you will still have to explicitly quit your session when you are finished. No data will be saved if the session times out:&nbsp;</strong></li></ul><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Center" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/2031305967-quit.png" data-imagenaturalheight="258" data-imagenaturalwidth="185" data-uniqueid="7092d86a-8dbd-411e-addc-52534f91affb" data-height="257.9993612491358" data-width="184.99954198096947" data-widthpercentage="16.313443036157025" data-uploading="0"></div><ul><li>To manually save and load your sessions, you can instead use the Session menu. If you choose this approach, <strong>make sure you remember to save your session before the time limit is up!&nbsp;</strong></li></ul><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Left" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/420160140-session_manual.png" data-imagenaturalheight="256" data-imagenaturalwidth="185" data-uniqueid="cdbce478-8105-4992-b0f1-41bd20b88b83" data-height="255.9993662006929" data-width="184.99954198096947" data-widthpercentage="16.313443036157025" data-uploading="0"></div>
<h3><span class="fontColorThemeSecondary">Resource Management</span></h3><p>Unlike Posit Workbench, RStudio OnDemand requires you to request a specific number of resources up front. Here are some guidelines to help you decide.</p><h4>CPUs</h4><ul><li>Only request 1 CPU unless you specifically know you need more. R will not use multithreading or multiprocessing unless you explicitly write code to do so.</li><li>Packages that support parallel execution, and therefore need more CPUs, include:<ul><li><a href="https://stat.ethz.ch/R-manual/R-devel/library/parallel/doc/parallel.pdf">parallel</a>, which is built in to R</li><li><a href="https://bioconductor.org/packages/release/bioc/html/BiocParallel.html">BiocParallel</a></li><li><a href="https://cran.r-project.org/web/packages/future/index.html">future</a></li><li>For more examples, refer to <a href="https://cran.r-project.org/web/views/HighPerformanceComputing.html">https://cran.r-project.org/web/views/HighPerformanceComputing.html</a>.</li></ul></li><li>When using the parallel package, avoid using parallel::detectCores(), which does not integrate well with Slurm. Instead, use <a href="https://parallelly.futureverse.org/reference/availableCores.html">parallelly::availableCores()</a>.</li></ul><h4>RAM</h4><ul><li>RStudio's Memory Usage Report doesn't work as you might expect with OnDemand, because your Slurm job is running within a much more powerful compute node. This means that the “used by system” and “total system memory” fields are not accurate to your job:</li></ul><div class="imagePlugin" style="background-color:transparent;position:relative;" data-alignment="Center" data-imageurl="/sites/rc2/SiteAssets/SitePages/RStudio-OnDemand/1981253427.png" data-overlaytextstyles="{&quot;textColor&quot;:&quot;light&quot;,&quot;isBold&quot;:false,&quot;isItalic&quot;:false,&quot;textBoxColor&quot;:&quot;dark&quot;,&quot;textBoxOpacity&quot;:0.54,&quot;overlayColor&quot;:&quot;light&quot;,&quot;overlayTransparency&quot;:0}" data-imagenaturalheight="306" data-imagenaturalwidth="566" data-siteid="93ee3842-f21b-4d8d-b85b-874e64c67802" data-webid="95711e2c-a16f-49a8-9adc-1b9756d4ee5e" data-listid="3d75202a-c480-42f5-abb7-5e7b39fc27d5" data-uniqueid="43986010-1eb0-4d2e-b494-189d2c966aa0" data-height="306" data-width="566" data-widthpercentage="47.64264236956352" data-uploading="0"></div><ul><li>Instead, to work out your memory usage, you have to divide your currently used memory (493 MB in the above case) by the amount of RAM you requested for your job.</li><li>If you aren't sure how much memory to request, start by allocating a smaller amount of RAM, such as 20 GB. If you find RStudio is not able to load the files you need to work with, then cancel the job and double the RAM. Repeat this process until you are able to run your workflow without requesting much more than you utilise.</li><li>If you find that you are using less than half of the RAM you requested, remember to reduce your RAM request next time you submit a job, to ensure you aren't wasting resources.</li></ul>
