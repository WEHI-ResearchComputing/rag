<h2>Interactive workloads</h2><p>present a challenge because, by nature, users need rapid access to resources however the resources needed to run a large workload may not be immediately available. Historically, WEHI has provided immediate access to resources, either via logging directly into a large Unix server or being guaranteed a private virtual machine (VM) on demand. This leads to resource contention, especially memory, which in turn leads to system instability and failed workloads.</p><p>To balance the requirements of rapid access to resources and stability Research Computing provide the options and guidelines below as to which option is most likely to suit your workload.</p><ul></ul>
<h3><span class="fontColorBlue">Content on this page:</span></h3><p><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#interactive-workloads" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#interactive-workloads" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#interactive-workloads"><span class="fontColorNeutralDark">Interactive workloads</span></a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#examples-of-interactive-tasks" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#examples-of-interactive-tasks" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#examples-of-interactive-tasks">Examples of interactive tasks</a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#slurm-interactive-sessions" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#slurm-interactive-sessions" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#slurm-interactive-sessions">Slurm interactive sessions</a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#to-start-an-interactive-session" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#to-start-an-interactive-session" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#to-start-an-interactive-session">To start an interactive session</a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#resources" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#resources" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#resources">Resources</a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#the-vc7-shared-systems" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#the-vc7-shared-systems" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#the-vc7-shared-systems">The vc7-shared systems</a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#rstudio" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#rstudio" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#rstudio">RStudio</a><br><a href="/sites/rc2/SitePages/Interactive-workloads.aspx#open-ondemand" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#open-ondemand" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Interactive-workloads.aspx#open-ondemand">Open OnDemand</a></p>
<h3><span class="fontColorThemeSecondary">Examples of interactive tasks</span></h3><ul><li>data management, eg. organising files, truncation and recall of files, downloading small datasets</li><li>software/workflow preparation, eg. developing/debugging scripts, downloading/building software</li><li>testing</li><li>lightweight interactive data analysis</li><li>long-running but lightweight processes such as workflow managers or simple web services.</li><li>rapid analysis cycles</li><li>using an application with a GUI.</li></ul><h3><span class="fontColorThemeSecondary">Slurm interactive sessions</span></h3><p>Interactive Slurm jobs allow a user to interact with applications in real-time within an HPC environment.</p><p>With interactive jobs, users request time and resources to work on a compute node directly. Users can then run graphical user interface (GUI) applications, execute scripts, or run other commands directly on a compute node. The advantage of an interactive batch job is that if resources are available, you will have access to them in less than a second, compared to the 10-20 minutes it takes to provision a VM.</p><p>On Milton, we encourage users to run interactive jobs on the interactive partition (queue) of Slurm. We cannot guarantee instant access to resources on Milton but the interactive partition is designed to have no wait time in most cases.</p><p>The maximum resources that can be allocated on an interactive partition are:</p><ul><li>1 job (session) per user</li><li>CPUs = 16</li><li>Memory = 64 GB</li><li>No GPUs.</li></ul><p>These numbers are subject to review, so if you have any comments or feedback, please email <a data-interception="off" title="mailto:research.computing@wehi.edu.au" href="mailto:research.computing@wehi.edu.au" data-cke-saved-href="mailto:research.computing@wehi.edu.au">Research Computing.</a></p><h4><span class="fontColorBlue">To start an interactive session</span></h4><ul><li>Connect to Slurm through a terminal</li></ul><pre style="margin-left:80px;"><span class="fontColorRed">ssh slurm-login.hpc.wehi.edu.au</span></pre><ul><li><p>Start an interactive session using <a data-interception="off" title="https://slurm.schedmd.com/salloc.html" href="https://slurm.schedmd.com/salloc.html" data-cke-saved-href="https://slurm.schedmd.com/salloc.html">salloc</a><br><br></p></li></ul><pre>[iskander.j@slurm-login02 ~]$ <span class="fontColorRed">salloc --partition interactive --job-name "IJob" --cpus-per-task 2  --time 24:00:00 --mem 1G</span>\nsalloc: Pending job allocation 896891\nsalloc: job 896891 queued and waiting for resources\nsalloc: job 896891 has been allocated resources\nsalloc: Granted job allocation 896891\nsalloc: Waiting for resource configuration\nsalloc: Nodes milton-sml-001 are ready for job\n[iskander.j@milton-sml-001 ~]$\n</pre><p><br>This started a job named <span class="fontColorBlue">“IJob”</span> with Job ID 896891 that uses 2 CPUs, 1GB, for 24hr. It may take a few seconds or more for the session to start, dependent on the resources required and the resources available.</p><ul><li>You can also use <a href="https://slurm.schedmd.com/srun.html" data-cke-saved-href="https://slurm.schedmd.com/srun.html">srun.</a></li></ul><p>Once, it is allocated, a normal bash command line is available on the allocated node (<em><span class="fontColorBlue">milton-sml-001</span></em> in the example above) to run your commands and tools.</p>
<div class="canvasRteResponsiveTable"><div class="tableCenterAlign tableWrapper"><table class=" cke_show_border"><tbody><tr><td style="text-align:center;width:72px;"><strong><span class="fontColorRed">Note:</span><em> </em></strong></td><td style="width:917px;">If your computer reboots or you lose your connection to the internet or the terminal/ssh session is closed for any reason, the interactive session will be cancelled and removed from the queue, whether it has started or not.</td></tr></tbody></table></div></div>
<div class="canvasRteResponsiveTable"><div class="tableCenterAlign tableWrapper"><table style="width:505px;" class="simpleTableStyleNeutral cke_show_border"><tbody><tr><td style="text-align:center;width:25px;"><span class="fontColorBlue"><strong>Tip:</strong></span></td><td style="text-align:center;width:417px;"><strong>Always run the interactive session from a<br><a href="https://www.gnu.org/software/screen/manual/screen.html" data-cke-saved-href="https://www.gnu.org/software/screen/manual/screen.html" target="_blank" title="https://www.gnu.org/software/screen/manual/screen.html" data-interception="off">screen</a> or <a href="https://github.com/tmux/tmux/wiki" data-cke-saved-href="https://github.com/tmux/tmux/wiki" target="_blank" title="https://github.com/tmux/tmux/wiki" data-interception="off">tmux</a>.</strong></td></tr></tbody></table></div></div>
<h4><span class="fontColorBlue">Use screen for your interactive session</span></h4><p><strong><a data-cke-saved-href="https://www.gnu.org/software/screen/manual/screen.html" href="https://www.gnu.org/software/screen/manual/screen.html"><em>screen</em></a></strong> is a full-screen window manager that provides a method to create windows (virtual terminals) for different processes to run in.</p><p>To attach a new <span class="fontColorBlue"><em>screen</em></span> screen and run your interactive session inside it:</p><pre><span class="fontColorRed">ssh slurm-login.hpc.wehi.edu.au \nscreen \nsalloc --partition interactive --job-name "IJob" --cpus-per-task 2 --time 24:00:00 --mem 1G </span>\n</pre><p><br>To detach the screen and return to your terminal, press <em><span class="fontColorBlue">Ctrl+a+d</span></em>.</p><p>To find all detached screens:</p><pre><span class="fontColorRed">screen -ls</span>\nThere are screens on:\n\t33401.ttys004.mac3515\t(Detached)\n\t33355.ttys004.mac3515\t(Detached)\n2 Sockets in /var/folders/07/57_jncm54x9ftfb142dbwwjm000425/T/.screen.\n</pre><p><em><span class="fontColorBlue">33401.ttys004.mac3515</span></em> and <em><span class="fontColorBlue">33355.ttys004.mac3515</span></em> represents screen ids.</p><p>To re-attach a screen, <em><span class="fontColorBlue">screen_id</span></em> is required if there is more than one detached screen:</p><pre><span class="fontColorRed">screen -r &lt;screen_id&gt;</span>\n</pre><p>For example:</p><pre><span class="fontColorRed">screen -r 33401 </span>\n</pre><p><br>You have to exit your screen (or <em><span class="fontColorBlue">scancel </span></em>the job) once you finish your work, to make sure no resources are still allocated.</p><pre><span class="fontColorRed">exit</span>\n</pre><p><br>It is also possible to run your script in an interactive session in one command by adding the path/name of your script to the end of the command, as follows</p><pre><span class="fontColorRed">salloc --job-name "IJ_myscript" --cpus-per-task 8 --mem-per-cpu 1G --time 24:00:00 --pty script.sh</span>\n</pre>
<div class="canvasRteResponsiveTable"><div class="tableCenterAlign tableWrapper"><table style="width:1016px;" class=" cke_show_border"><tbody><tr><td style="text-align:center;width:55px;"><span class="fontColorBlue"><strong>Tip:</strong></span></td><td style="text-align:center;width:907px;">Once you have a mature design, it is recommended to run your scripts in the batch system, not interactively.</td></tr></tbody></table></div></div>
<p>If you require more resources than are available in the interactive partition, you can remove the partition option from your cmd and the job will run in the default partition (regular). Slurm will manage the allocation in the appropriate partition with the suitable resources. This may take longer depending on the availability of the requested resource:</p><pre><span class="fontColorRed">salloc --job-name "IJ" --cpus-per-task 64 –mem 2000  --time 1:00:00 \n</span></pre><p><br>Also, if your task requires GPUs, you can request your allocation on <span class="fontColorBlue">gpuq</span> partition:</p><pre><span class="fontColorRed">salloc  --partition gpuq  --gpus-per-node 1 --cpus-per-task 10 --mem 1000 </span>\n</pre><p>On the other hand, the main disadvantage is that you need to make sure your interactive login session is kept alive. If you close your laptop or there is a network failure you will lose the interactive batch job and everything that was running in it.</p><h4><span class="fontColorBlue">Resources:</span></h4><ul><li><a data-cke-saved-href="https://slurm.schedmd.com/salloc.html" href="https://slurm.schedmd.com/salloc.html" target="_blank" title="https://slurm.schedmd.com/salloc.html" data-interception="off">SALLOC</a> manual</li><li><a data-cke-saved-href="https://slurm.schedmd.com/srun.html" href="https://slurm.schedmd.com/srun.html" target="_blank" title="https://slurm.schedmd.com/srun.html" data-interception="off">SRUN</a> manual<br><br><br></li></ul><h3><span class="fontColorThemeSecondary">The vc7-shared systems</span></h3><p>Another option for lightweight interactive workloads is <strong>vc7-shared</strong>.</p><pre><span class="fontColorRed">ssh vc7-shared</span>\n</pre><p><br><strong>vc7-shared</strong> uses <em><span class="fontColorBlue">/home/users/allstaff/</span></em></p><p>cgroup limits are applied where each user can use up to 4 CPUs and 24 GB. However,&nbsp;there is still a risk of resource contention. As a rough guide, please limit single workloads to:</p><ul><li>24 hours elapsed time for heavy workloads</li><li>&lt;24 GB of RAM</li><li>&lt;4 CPU Cores</li><li>moderate IO loads.<br><br></li></ul><p>In the majority of use cases, running in the batch system will be straightforward and will provide better service for you and other users.</p>
<div class="canvasRteResponsiveTable"><div class="tableCenterAlign tableWrapper"><table style="width:911px;" class=" cke_show_border"><tbody><tr><td style="text-align:center;width:94px;"><span class="fontColorBlue"><strong>Tip:</strong></span></td><td style="text-align:center;width:765px;"><strong>Slurm batch jobs can also be submitted from <em><span class="fontColorBlue">vc7-shared</span></em>.</strong></td></tr></tbody></table></div></div>
<h3><span class="fontColorThemeSecondary">RStudio</span></h3><p>RStudio has a dedicated server:<br><br></p><ul><li>RStudio Server Pro <a href="https://rstudio.hpc.wehi.edu.au" data-cke-saved-href="https://rstudio.hpc.wehi.edu.au" target="_blank" title="https://rstudio.hpc.wehi.edu.au" data-interception="off">rstudio.hpc.wehi.edu.au</a></li></ul><p>The RStudio Server Pro system lets users manage different versions of R and libraries.</p><p>You can also run R scripts in Slurm batch jobs.</p><p>Learn more about <a href="/sites/rc2/SitePages/R-services.aspx" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/R-services.aspx" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/R-services.aspx">R services at WEHI</a>, as well as&nbsp;<a href="/sites/rc2/SitePages/RStudio.aspx" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/RStudio.aspx" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/RStudio.aspx">R Studio</a>.​​​​​</p>
<h3><span class="fontColorThemeSecondary">Open OnDemand</span></h3><p>WEHI runs an OnDemand server available through <a data-cke-saved-href="https://ondemand.hpc.wehi.edu.au/" href="https://ondemand.hpc.wehi.edu.au/" title="https://ondemand.hpc.wehi.edu.au/" data-interception="off">ondemand.hpc.wehi.edu.au</a>. OnDemand provides a number of options for running GUI applications in the batch system, including RStudio.</p><p>You can open an RStudio server session or a Jupyter notebook through Open OnDemand, and it will use resources provisioned through SLURM.</p><p>Read more about&nbsp;<a href="/sites/rc2/SitePages/Open-OnDemand.aspx" data-cke-saved-href="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Open-OnDemand.aspx" data-interception="on" title="https://wehieduau.sharepoint.com/sites/rc2/SitePages/Open-OnDemand.aspx">Open OnDemand in our user guide</a>.</p>
