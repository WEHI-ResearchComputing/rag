<h2><span class="fontColorThemeSecondary">Upgrade Plan</span></h2><p>ITS RS is planning to update Milton from Centos 7, which is at end-of-life, to the latest <a href="https://developers.redhat.com/articles/2022/05/18/whats-new-red-hat-enterprise-linux-9" data-interception="off" target="_blank" rel="noopener noreferrer"><u>Red Hat Enterprise Linux 9 (RHEL 9)</u></a> between <strong>Thursday 15 to Monday 19 August</strong>, 2024. An outage is required for this upgrade to take place. During this upgrade outage, <span class="fontColorRedDark"><strong>all Milton services will be offline</strong></span>. Below is a list of services that will be affected.</p><p aria-hidden="true">&nbsp;</p><h3><span class="fontColorThemeSecondary">Expected Changes and Recommendations</span></h3><p><span class="fontColorRedDark"><strong>Please be patient when the system comes back online. The number, size and complexity of changes made means there will probably be things that don't quite work, despite our extensive preparation and testing.</strong></span><strong>&nbsp;</strong></p><p aria-hidden="true">&nbsp;</p><p><strong>Please submit a ticket, if things aren't quite working well, and describe your issue in as much detail as possible (including loaded modules, job number and error message).</strong></p><p aria-hidden="true">&nbsp;</p><h4><span class="fontColorThemeSecondary">Symbolic Path Links</span></h4><p>After the upgrade,<span class="fontColorThemeSecondary"> /wehi</span> and<span class="fontColorThemeSecondary"> /wehisan</span> paths will no longer be available. Instead, make sure to use absolute full path <span class="fontColorThemeSecondary">/stornext/…&nbsp;</span></p><p>&nbsp;</p><p>You can determine the corresponding /stornext path using the realpath command. For example:</p><pre>$ realpath /wehisan/genomics/<br>/stornext/Genomics/data</pre><h4><span class="fontColorThemeSecondary">Known issues with Python environments and R libraries after the OS upgrade</span></h4><p>These are the known scenarios in which you will need to rebuild packages</p><ul><li>Python virtual environments<ul><li>These will likely need to be reproduced in their entirety.</li></ul></li><li>R packages<ul><li>Packages that rely on external libraries like HDF5 or Magick will probably need to be re-installed.</li><li>Other packages should not experience any issues, assuming you use the same R version and the same linear-algebra back-end.</li></ul></li></ul><p aria-hidden="true">&nbsp;</p><p style="margin-left:0px;">In any of the above cases, after the upgrade, you might receive errors such as “ImportError: XXX.so.6: cannot open shared object file: No such file or directory” when loading a package in Python or R. This error indicates that you need to reinstall that package. For example, if this occurs when running <i>import numpy</i> in Python, you will have to run <i>pip install numpy</i>. If this occurs when using <i>library(dplyr) </i>in R, then you will have to run <i>install.packages("dplyr")</i>.</p><p style="margin-left:0px;" aria-hidden="true">&nbsp;</p><h3 style="margin-left:0px;"><span class="fontColorThemeSecondary">Future Proofing</span></h3><p style="margin-left:0px;">From <span class="fontColorThemeSecondary"><strong>early May</strong></span>, an updated node with RHEL9 will be available to all Milton users to test their tools and code and update their packages where required. This node will also be available throughout the upgrade outage.</p><p style="margin-left:0px;" aria-hidden="true">&nbsp;</p><h4 style="margin-left:0px;">Python Virtual environments</h4><p style="margin-left:0px;">We suggest that for Python virtual environments, that you use (with your virtual environment activated)</p><p style="margin-left:0px;" aria-hidden="true">&nbsp;</p><pre>pip freeze &gt; requirements.txt</pre><p style="margin-left:0px;">Pip freeze prints a list of installed packages, with their versions, and saves that to a file called “requirements.txt”. <i>After</i> the OS has been upgraded, and after you've created a new Python environment with one of the new python modules, you can install the same packages into that environment with&nbsp;</p><pre>pip install -r requirements.txt</pre><p style="margin-left:0px;">If you wish to recreate your Conda environment, you can try using <a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#cloning-an-environment">conda clone</a>.</p><p style="margin-left:0px;" aria-hidden="true">&nbsp;</p><h4 style="margin-left:0px;">R packages</h4><p style="margin-left:0px;">For problematic packages, you should be able to reinstall them with</p><pre>install.packages("problematic-package")</pre><p style="margin-left:0px;">as mentioned previously.</p><p style="margin-left:0px;" aria-hidden="true">&nbsp;</p><h3 style="margin-left:0px;"><span class="fontColorThemeSecondary">Legacy Support</span></h3><p style="margin-left:0px;">Once the upgrade has been deployed, IT will provide a Singularity container that mimics the old operating system's libraries. This will allow you to run code only compatible with the old operating system. However, we instead recommend re-compiling your software if at all possible to avoid the need to use these containers.</p><h3><br><span class="fontColorThemeSecondary">List of Affected Services&nbsp;</span></h3><p style="margin-left:0cm;"><strong><u>Milton:</u>&nbsp;</strong>All systems, servers, virtual machines and processes reliant upon HPC network switches. This includes:&nbsp;</p><ol><li>cryoSPARC&nbsp;&nbsp;</li><li>OnDemand&nbsp;&nbsp;</li><li>Guacamole.hpc&nbsp;</li><li>All Imaging&nbsp;VMs&nbsp;</li><li>All MSCypher/Protlab&nbsp;VMs&nbsp;</li><li>Pipeline Pilot&nbsp;</li><li>Rstudio/Posit Workbench&nbsp;</li><li>WEHI-Shiny.hpc&nbsp;</li><li>SLURM compute nodes&nbsp;</li><li>SLURM batch queueing system&nbsp;&nbsp;</li><li>SLURM login nodes&nbsp;&nbsp;</li><li>vc7-shared&nbsp;&nbsp;</li><li><p>All vc7- VMs&nbsp;and ability to request/manage VMs&nbsp;</p><p aria-hidden="true">&nbsp;</p></li></ol><p style="margin-left:0cm;"><strong><u>Core:</u>&nbsp;</strong>no access to data through NAS</p><ol><li>StorNext File Systems:&nbsp;<ol><li>Admin&nbsp;</li><li>Archive&nbsp;</li><li>Bioinf&nbsp;</li><li>General&nbsp;</li><li>Genomics&nbsp;</li><li>Home&nbsp;</li><li>ImageData&nbsp;</li><li>Img&nbsp;</li><li>Projects&nbsp;</li><li>SBPM&nbsp;</li><li>Sysbio&nbsp;</li><li>System&nbsp;</li><li>GP_transfer&nbsp;</li></ol></li><li>Application Services:&nbsp;<ol><li>CaseCenter&nbsp;</li><li>Columbus&nbsp;</li><li>Omero&nbsp;</li><li>WEHITV Macs/PCs&nbsp;</li></ol></li></ol><p style="margin-left:0cm;" aria-hidden="true">&nbsp;</p><h3 style="margin-left:0cm;"><span class="fontColorThemeSecondary">Services Not Affected</span></h3><ol><li>GUS</li><li>OneDrive</li><li>Redcap&nbsp;</li><li>SharePoint</li></ol>
