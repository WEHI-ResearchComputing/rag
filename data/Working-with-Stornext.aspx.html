<p>Stornext Read Only</p><p aria-hidden="true">&nbsp;</p><p>Because Stornext is intended as an archival space and not a working space, Stornext is “Read Only” from jobs submitted by Slurm. This means that jobs submitted with sbatch, srun, or salloc; and from OnDemand cannot write to Stornext (with the exception of jobs running on the “datamover” partition). See below diagrams for illustrations of where you can and can't write from Stornext.</p>
<h2><span class="fontColorThemeSecondary">How to work with Stornext</span></h2><h3><span class="fontColorThemeSecondary">When do I need to tar and compress directories before moving to Stornext?</span></h3><p>Where possible, we recommend that folders with files smaller than a 100MB <strong>be tarred before moving</strong> to Stornext.</p><p>Where possible, we also recommend archiving compressed formats like CRAM instead of BAM to Stornext.&nbsp;</p><p aria-hidden="true">&nbsp;</p><h3><span class="fontColorThemeSecondary">How do I transfer my results to stornext to be archived?</span></h3><p>Where possible, tar and compress your results and any files essential for reproducibility. Next step is moving using cp or rsync to your Stornext lab share. For example, the datamover partition can be used with:</p><pre># cp (copy)<br>sbatch -p datamover --wrap "cp &lt;file1&gt; &lt;file2&gt; ... /stornext/&lt;destination&gt;"<br><br># rsync<br>sbatch -p datamover --wrap "rsync -a &lt;file1&gt; &lt;file2&gt; ... /stornext/&lt;destination&gt;"</pre><p>The transfer can be done through any of the following:</p><ol><li>A Slurm job that uses the datamover partition</li><li>From the command line on slurm-login or vc7-shared login nodes</li><li>Using the Open Ondemand file manager, but this will not work for very large files.</li></ol><p aria-hidden="true">&nbsp;</p><p>After the files has been backed up, you can truncate them to free up space in your project/lab space.</p><p aria-hidden="true">&nbsp;</p><h3><span class="fontColorThemeSecondary">Where do I store my code?</span></h3><p>Code should be managed using git and committed to GitHub or similar repositories (e.g., GitLab and BitBucket). <strong>Git allows you to work simultaneously with your colleagues; and facilitates version control, traceability, and rollback capabilities</strong>. Additionally, Git and remote repositories (e.g. GitHub) are extremely useful for demonstrating provenance and ownership.</p><p aria-hidden="true">&nbsp;</p><p>If you need to backup code to tape (e.g. for reproducibility), then it should be done by tarring and compressing before moving using cp or rsync to your Stornext lab share.&nbsp;</p><p aria-hidden="true">&nbsp;</p><p>VAST should be used to store code that is actively being developed, and should be regularly committed to a remote git repository.</p><p aria-hidden="true">&nbsp;</p><p>VSCode, Rstudio, and Posit Workbench <a href="https://docs.posit.co/ide/user/ide/guide/tools/version-control.html">include Git integrations</a> to make your workflow with git seamless.</p><p aria-hidden="true">&nbsp;</p><p>Training on how to use git is available on <a href="/sites/rc2/SitePages/RCP-Training.aspx" data-interception="off" target="_blank" rel="noopener noreferrer">our RCP training page</a>. If you need more training please reach out to <a href="mailto:research.computing@wehi.edu.au" data-interception="off" target="_blank" rel="noopener noreferrer">research.computing@wehi.edu.au</a></p><p aria-hidden="true">&nbsp;</p><h3><span class="fontColorThemeSecondary">How will Nextflow pipelines be affected?</span></h3><p>Nextflow processes can read from Stornext but not write any results there. But, the master Nextflow process can write to Stornext using the publishDir directive. Set your publishDir to VAST Scratch/Projects.</p><pre>nextflow run ... -process.publishDir /stornext/...</pre><p>Or, if your pipeline has an “outputDir” (or similar) parameter, the following should also work.</p><pre>nextflow run ... --outputDir /stornext/…</pre><p>To move results to Stornext, you can do either of the following:</p><ol><li>Add an extra step to your pipeline that collects all results files in one folder, tar/compress it then move it to your Stornext lab share. Truncate these files as soon as possible.</li><li>After the successful completion of the pipeline, collect all results into one folder, &nbsp;tar/compress, then move to Stornext using Open Ondemand File manager (small files) or rsync command.</li></ol><p aria-hidden="true">&nbsp;</p><p>Note that by default, Seqera Platform submits master processes to the “regular” partition. If you need to archive files from a Seqera Platform pipeline, please send an email to <a href="mailto:support@wehi.edu.au">support@wehi.edu.au</a>.</p>
