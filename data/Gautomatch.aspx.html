<h2>Gautomatch</h2><p>Gautomatch is a GPU accelerated program for accurate, fast, flexible, and fully automatic particle picking from cryo-EM micrographs with or without templates. It was developed by Dr. Kai Zhang (<a data-cke-saved-href="mailto:kzhang@mrc-lmb.cam.ac.uk" href="mailto:kzhang@mrc-lmb.cam.ac.uk">kzhang@mrc-lmb.cam.ac.uk</a>), MRC Laboratory of Molecular Biology.</p><p>The tutorial below was provided by Dr. Alisa Glukhova.</p>
<h3><span class="fontColorThemeSecondary">Steps to run Gautomatch on Milton</span><br><br></h3><div class="canvasRteResponsiveTable"><div class="tableWrapper"><table style="width:546px;" class=" cke_show_border"><tbody><tr><td style="width:7px;">1</td><td style="width:486px;"><p>Create directory <span class="fontColorBlue"><em>Gautomatch</em></span> – best inside your Relion folder</p><pre><span class="fontSizeMedium">mkdir Gautomatch\ncd Gautomatch</span></pre></td></tr><tr><td style="width:7px;">2</td><td style="width:486px;"><p>Inside <span class="fontColorBlue"><em>Gautomatch</em></span> create directory <em><span class="fontColorBlue">fulldata</span></em></p><pre><span class="fontSizeMedium">mkdir fulldata\ncd fulldata</span></pre></td></tr><tr><td style="width:7px;">3</td><td style="width:486px;"><p>Link mrc files from MotionCorr job. You can link either DW or noDW. I usually do noDW (better signal/noise)</p><pre><span class="fontSizeMedium">ln -s ../../MotionCorr/jobXXX/Micrographs/*_noDW.mrc .\ncd ../</span></pre></td></tr><tr><td style="width:7px;">4</td><td style="width:486px;"><p>Copy <span class="fontColorBlue"><em>class_averages.mrcs</em></span>&nbsp;and <span class="fontColorBlue"><em>gautomatch.bash</em></span> from <span class="fontColorRed"><span class="highlightColorGrey">/stornext/System/data/apps/sample-scripts/cryoem/gautomatch</span></span> into the <span class="fontColorBlue"><em>Gautomatch</em></span> directory.<br>​​​​​​​<span class="fontColorBlue"><em>class_averages.mrcs</em></span> can be created by doing a “Select” type job in relion or making projections from an existing 3D volume (relion_project utility). Making projections ensures that you have all orientations possible in your templates.</p></td></tr><tr><td style="width:7px;">5</td><td style="width:486px;"><p>Modify <span class="fontColorBlue"><em>gautomatch.bash</em></span> according to your data:</p><pre><span class="fontSizeMedium">Gautomatch_v0.56_sm30-75_cu10.1 --do_unfinished --apixM 0.84 --T class_averages.mrcs --apixT 0.86 --diameter 180 --lp 20 --hp 1000 --min_dist 140 --speed 1 --cc_cutoff 0.01  ./fulldata/*.mrc</span>\n</pre><p>Recommended parameters to change:</p><ul><li><em><span class="fontColorBlue">--apixM</span></em> – pixel size of your micrograph</li><li><em><span class="fontColorBlue">--apixT </span></em>– pixel size of your templates</li><li><em><span class="fontColorBlue">--diameter 180</span></em> – diameter of your particle (I usually do 20-30 angstrom less then the actual diameter)</li><li><em><span class="fontColorBlue">--min_dist 140 </span></em>– distance between particles<br>​​​​​​​(less distance – more picks, but usually results in overpicking). I usually do ~75% of the particle size</li></ul></td></tr></tbody></table></div></div><p><br></p>
<p><br><br></p><div class="canvasRteResponsiveTable"><div class="tableWrapper"><table style="width:546px;" class=" cke_show_border"><tbody><tr><td style="width:7px;">6</td><td style="width:486px;"><p>Submit script to Slurm</p><pre><span class="fontSizeMedium">sbatch gautomatch.bash</span>\n</pre></td></tr><tr><td style="width:7px;">7</td><td style="width:486px;">Check the <em>Gautomatch-XXXjobIDXX.out</em> and <em>Gautomatch-XXXjobIDXX.err</em> in <span class="fontColorBlue"><em>Gautomatch</em></span> folder to make sure it is running</td></tr><tr><td style="width:7px;">8</td><td style="width:486px;"><p>After it finishes rename the picks<br>(is using noDW micrographs, otherwise – no need)</p><pre><span class="fontSizeMedium">rename '_noDW_automatch.star'  '_automatch.star' *_automatch.star</span>\n</pre></td></tr><tr><td style="width:7px;">9</td><td style="width:486px;"><p>Link the picks back into the <em><span class="fontColorBlue">MotionCorr/jobXXX/Micrographs</span></em> folder.</p><pre><span class="fontSizeMedium">cd ../../MotionCorr/jobXXX/Micrographs\nln -s ../../../Gautomatch/fulldata/*_automatch.star </span>\n</pre></td></tr><tr><td style="width:7px;">10</td><td style="width:486px;">Import the particles into relion through the Import type job <span class="fontColorBlue"><em>(importing particle coordinates)-job YYY</em></span></td></tr><tr><td style="width:7px;">11</td><td style="width:486px;"><p>If you want to open and examine the picks in the relion – need to fix the Import string</p><pre><span class="fontSizeMedium">cd Import/jobYYY\nnano coords_suffix_automatch.star\n</span></pre><p>change <em><span class="fontColorBlue">MotionCorr/jobXXX/Micrographs/.mrc</span> to <span class="fontColorBlue">"MotionCorr/job003/Micrographs/.mrc"</span></em>&nbsp;<br>(add the double quotes)</p></td></tr><tr><td style="width:7px;">12</td><td style="width:486px;">Now if you look at the output of the Import job in the Relion GUI you should be able to see what you picked. If you are not satisfied <em><span class="fontColorBlue">– adjust --diameter</span></em> and <span class="fontColorBlue"><em>--min_dist</em></span></td></tr></tbody></table></div></div><p><br></p>
